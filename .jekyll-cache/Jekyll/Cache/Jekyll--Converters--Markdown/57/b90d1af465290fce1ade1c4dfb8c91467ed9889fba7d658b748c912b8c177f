I"ËR<p>Trong bÃ i viáº¿t nÃ y mÃ¬nh sáº½ nÃ³i Ä‘áº¿n bÃ i toÃ¡n phÃ¢n lá»›p vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Ã¡nh giÃ¡ 1 mÃ´ hÃ¬nh phÃ¢n lá»›p.</p>

<h1 id="bÃ i-toÃ¡n-phÃ¢n-lá»›p">BÃ i toÃ¡n phÃ¢n lá»›p</h1>

<p>MÃ¬nh sáº½ sá»­ dá»¥ng bá»™ dá»¯ liá»‡u MNIST, gá»“m 70.000 áº£nh nhá» cá»§a cÃ¡c sá»‘ viáº¿t tay bá»Ÿi ngÆ°á»i á»Ÿ US. Má»—i áº£nh Ä‘Æ°á»£c Ä‘Ã¡nh nhÃ£n vá»›i sá»‘ tÆ°Æ¡ng á»©ng. Táº­p dá»¯ liá»‡u nÃ y Ä‘Æ°á»£c dÃ¹ng cá»±c kÃ¬ phá»• biáº¿n trong huáº¥n luyá»‡n cÃ¡c thuáº­t toÃ¡n vÃ  thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  bá»™ dá»¯ liá»‡u â€œHello Worldâ€ trong Machine learning. NÃ³i chung lÃ  ai há»c machine learning thÃ¬ sá»›m hay muá»™n cÅ©ng pháº£i sá»­ dá»¥ng MNIST =))</p>

<h2 id="dá»¯-liá»‡u-huáº¥n-luyá»‡n">Dá»¯ liá»‡u huáº¥n luyá»‡n</h2>

<p>Scikit-Learn cung cáº¥p nhiá»u functions Ä‘á»ƒ táº£i vá» cÃ¡c bá»™ dá»¯ liá»‡u Ä‘á»ƒ huáº¥n luyá»‡n. Trong Ä‘Ã³ cÃ³ MNIST. Äoáº¡n code sau Ä‘Ã¢y Ä‘á»ƒ táº£i vá» dataset:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s">'mnist_784'</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mnist</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">dict_keys</span><span class="p">([</span><span class="s">'data'</span><span class="p">,</span> <span class="s">'target'</span><span class="p">,</span> <span class="s">'feature_names'</span><span class="p">,</span> <span class="s">'DESCR'</span><span class="p">,</span> <span class="s">'details'</span><span class="p">,</span>
<span class="s">'categories'</span><span class="p">,</span> <span class="s">'url'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau Ä‘Ã³ xem káº¿t quáº£</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>Letâ€™s look at these arrays:
&gt;&gt;&gt; X, y = mnist["data"], mnist["target"] &gt;&gt;&gt; X.shape
(70000, 784)
&gt;&gt;&gt; y.shape
(70000,)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>CÃ³ 70k áº£nh vÃ  má»—i áº£nh cÃ³ 784 features. Bá»Ÿi vÃ¬ má»—i áº£nh cÃ³ 28x28 pixels vÃ  má»—i feature Ä‘Æ¡n giáº£n Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi 1 mÃ u tá»« 0 (white) Ä‘áº¿n 255 (black).</p>

<p>Thá»­ in thá»­ 1 áº£nh trong bá»™ dataset Ä‘á»ƒ xem:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="n">mpl</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">some_digit</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">some_digit_image</span> <span class="o">=</span> <span class="n">some_digit</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">some_digit_image</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">binary</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">"nearest"</span><span class="p">)</span> <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">"off"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>BÃ¢y giá» ta thá»­ xem 1 vÃ i máº«u trong táº­p MNIST:</p>

<p><img src="/assets/img/blog/Ten-samples-for-each-digit-in-the-MNIST-dataset.png" alt="Dataset" />
<em>Dataset MNIST</em></p>

<p>PhÃ¢n chia táº­p dá»¯ liá»‡u, chÃºng ta sáº½ tiáº¿n hÃ nh chia bá»™ dá»¯ liá»‡u ra lÃ m 2 pháº§n: 1 pháº§n Ä‘á»ƒ training (huáº¥n luyá»‡n) gá»“m 60k áº£nh Ä‘áº§u tiÃªn vÃ  1 pháº§n Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ (test) gá»“m 10k áº£nh cuá»‘i cá»§a táº­p dá»¯ liá»‡u.</p>

<p>X_train, X_test, y_train, y_test = X[:60000], X[60000:], y[:60000], y[60000:]
Huáº¥n luyá»‡n bá»™ phÃ¢n lá»›p nhá»‹ phÃ¢n (Binary Classifier)
Äá»ƒ cho Ä‘Æ¡n giáº£n, chÃºng ta sáº½ tiáº¿n hÃ nh phÃ¢n lá»›p vá»›i 1 sá»‘, trong vÃ­ dá»¥ nÃ y lÃ  sá»‘ 5. Bá»™ phÃ¡t hiá»‡n sá»‘ 5 Ä‘Æ°á»£c gá»i lÃ  1 bá»™ phÃ¢n lá»›p nhá»‹ phÃ¢n (Ä‘Ãºng hoáº·c sai)</p>

<h2 id="chuáº©n-bá»‹-dá»¯-liá»‡u">Chuáº©n bá»‹ dá»¯ liá»‡u</h2>
<p>BÃ¢y giá» chÃºng ta sáº½ táº¡o táº­p dá»¯ liá»‡u Ä‘á»ƒ huáº¥n luyá»‡n:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1">#  y Ä‘Æ°á»£c gÃ¡n nhÃ£n lÃ  True náº¿u nhÃ£n cá»§a y lÃ  sá»‘ 5, False náº¿u nhÃ£n khÃ´ng pháº£i sá»‘ 5
</span><span class="n">y_train_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_train</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">y_test_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<h2 id="xÃ¢y-dá»±ng-vÃ -huáº¥n-luyá»‡n-mÃ´-hÃ¬nh">XÃ¢y dá»±ng vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh</h2>
<p>Sau khi Ä‘Ã£ cÃ³ táº­p dá»¯ liá»‡u Ä‘á»ƒ huáº¥n luyá»‡n, bÃ¢y giá» chÃºng ta sáº½ xÃ¡c Ä‘á»‹nh bá»™ phÃ¢n lá»›p phÃ¹ há»£p Ä‘á»ƒ thá»±c hiá»‡n phÃ¢n loáº¡i. á» bÃ i viáº¿t nÃ y mÃ¬nh sá»­ dá»¥ng bá»™ phÃ¢n lá»›p Stochastic Gradient Descent (SGD)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span> <span class="n">sgd_clf</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sgd_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_5</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>SGDClassifier dá»±a vÃ o viá»‡c láº¥y ngáº«u nhiÃªn trong quÃ¡ trÃ¬nh training (do Ä‘Ã³ Ä‘Æ°á»£c stochastic). Náº¿u báº¡n muá»‘n káº¿t quáº£ khÃ´ng Ä‘á»•i sau má»—i láº§n cháº¡y, báº¡n nÃªn Ä‘áº·t thÃªm tham sá»‘ random_state
Dá»± Ä‘oÃ¡n káº¿t quáº£ sau khi huáº¥n luyá»‡n
Sau khi huáº¥n luyá»‡n xong chÃºng ta sáº½ thá»±c hiá»‡n cháº¡y thá»­ mÃ´ hÃ¬nh.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">sgd_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">([</span><span class="n">some_digit</span><span class="p">])</span>
<span class="c1"># array([ True])
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau khi Ä‘Ã£ cháº¡y xong viá»‡c huáº¥n luyá»‡n mÃ´ hÃ¬nh, chÃºng ta sáº½ Ä‘i vÃ o Ä‘Ã¡nh giÃ¡ Ä‘á»™ chÃ­nh xÃ¡c mÃ´ hÃ¬nh trong viá»‡c dá»± Ä‘oÃ¡n.</p>

<h1 id="cÃ¡c-phÆ°Æ¡ng-phÃ¡p-Ä‘Ã¡nh-giÃ¡-mÃ´-hÃ¬nh-dá»±-Ä‘oÃ¡n">CÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n</h1>

<h2 id="cross-validation">Cross-validation.</h2>

<p>PhÆ°Æ¡ng phÃ¡p tá»‘t nháº¥t Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ 1 mÃ´ hÃ¬nh há»c mÃ¡y Ä‘Ã³ lÃ  cross-validation. Cross-validation lÃ  má»™t phÆ°Æ¡ng phÃ¡p kiá»ƒm tra Ä‘á»™ chÃ­nh xÃ¡c cá»§a 1 mÃ¡y há»c dá»±a trÃªn má»™t táº­p dá»¯ liá»‡u há»c cho trÆ°á»›c. Thay vÃ¬ chá»‰ dÃ¹ng má»™t pháº§n dá»¯ liá»‡u lÃ m táº­p dá»¯ liá»‡u há»c thÃ¬ cross-validation dÃ¹ng toÃ n bá»™ dá»¯ liá»‡u Ä‘á»ƒ dáº¡y cho mÃ¡y. á» bÃ i nÃ y mÃ¬nh sáº½ sá»­ dá»¥ng K-fold, Ä‘Ã¢y lÃ  phÆ°Æ¡ng phÃ¡p dÃ¹ng toÃ n bá»™ dá»¯ liá»‡u vÃ  chia thÃ nh K táº­p con. QuÃ¡ trÃ¬nh há»c cá»§a mÃ¡y cÃ³ K láº§n. Trong má»—i láº§n, má»™t táº­p con Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ kiá»ƒm tra vÃ  K-1 táº­p cÃ²n láº¡i dÃ¹ng Ä‘á»ƒ dáº¡y.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span> <span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">clone</span>
<span class="n">skfolds</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">skfolds</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_5</span><span class="p">):</span>
  <span class="n">clone_clf</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="n">sgd_clf</span><span class="p">)</span>
  <span class="n">X_train_folds</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
  <span class="n">y_train_folds</span> <span class="o">=</span> <span class="n">y_train_5</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
  <span class="n">X_test_fold</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span> <span class="n">y_test_fold</span> <span class="o">=</span> <span class="n">y_train_5</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
  <span class="n">clone_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_folds</span><span class="p">,</span> <span class="n">y_train_folds</span><span class="p">)</span>
  <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clone_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_fold</span><span class="p">)</span>
  <span class="n">n_correct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y_test_fold</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">n_correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))</span> <span class="c1"># Láº§n lÆ°á»£t lÃ  0.9502, 0.96565 vÃ  0.96495
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>Äá»ƒ rÃºt gá»n thÃ¬ thÆ° viá»‡n sklearn Ä‘Ã£ cung cáº¥p sáºµn hÃ m Ä‘á»ƒ thá»±c hiá»‡n:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">sgd_clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_5</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">"accuracy"</span><span class="p">)</span>
<span class="c1"># array([0.96355, 0.93795, 0.95615])
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="confusion-matrix">Confusion Matrix</h2>

<p>Má»™t phÆ°Æ¡ng phÃ¡p tá»‘t hÆ¡n Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ performance cá»§a mÃ´ hÃ¬nh phÃ¢n lá»›p Ä‘Ã³ lÃ  confusion matrix (ma tráº­n nháº§m láº«n). Ã tÆ°á»Ÿng chÃ­nh lÃ  Ä‘áº¿m sá»‘ láº§n pháº§n tá»­ thuá»™c class A bá»‹ phÃ¢n loáº¡i nháº§m vÃ o class B.</p>

<p>Äá»ƒ thá»±c hiá»‡n tÃ­nh toÃ¡n ma tráº­n nháº§m láº«n, Ä‘áº§u tiÃªn báº¡n pháº£i cÃ³ káº¿t quáº£ cÃ¡c dá»± Ä‘oÃ¡n vÃ  so sÃ¡nh vá»›i nhÃ£n tháº­t cá»§a nÃ³. NghÄ©a lÃ  chÃºng ta pháº£i dá»± Ä‘oÃ¡n trÃªn táº­p test, sau Ä‘Ã³ dÃºng káº¿t quáº£ dá»± Ä‘oÃ¡n nÃ y Ä‘á»ƒ so sÃ¡nh vá»›i nhÃ£n ban Ä‘áº§u.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_predict</span>
<span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">sgd_clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_5</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau Ä‘Ã³ xÃ¡c Ä‘á»‹nh ma tráº­n nháº§m láº«n:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train_5</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
<span class="c1"># array([[53057, 1522],
#		[ 1325,  4096]])
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>Ma tráº­n nháº§m láº«n sáº½ cho chÃºng ta nhiá»u thÃ´ng tin vá» cháº¥t lÆ°á»£ng cá»§a bá»™ phÃ¢n lá»›p.</p>

<ul>
  <li>TP (True Positive): Sá»‘ lÆ°á»£ng dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c. LÃ  khi mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n Ä‘Ãºng má»™t sá»‘ lÃ  sá»‘ 5.</li>
  <li>TN (True Negative): Sá»‘ lÆ°Æ¡ng dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c má»™t cÃ¡ch giÃ¡n tiáº¿p. LÃ  khi mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n Ä‘Ãºng má»™t sá»‘ khÃ´ng pháº£i sá»‘ 5, tá»©c lÃ  viá»‡c khÃ´ng chá»n trÆ°á»ng há»£p sá»‘ 5 lÃ  chÃ­nh xÃ¡c.</li>
  <li>FP (False Positive - Type 1 Error): Sá»‘ lÆ°á»£ng cÃ¡c dá»± Ä‘oÃ¡n sai lá»‡ch. LÃ  khi mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n má»™t sá»‘ lÃ  sá»‘ 5 vÃ  sá»‘ Ä‘Ã³ láº¡i khÃ´ng pháº£i lÃ  sá»‘ 5</li>
  <li>FN (False Negative - Type 2 Error): Sá»‘ lÆ°á»£ng cÃ¡c dá»± Ä‘oÃ¡n sai lá»‡ch má»™t cÃ¡ch giÃ¡n tiáº¿p. LÃ  khi mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n má»™t sá»‘ khÃ´ng pháº£i sá»‘ 5 nhÆ°ng sá»‘ Ä‘Ã³ láº¡i lÃ  sá»‘ 5, tá»©c lÃ  viá»‡c khÃ´ng chá»n trÆ°á»ng há»£p sá»‘ 5 lÃ  sai.</li>
</ul>

<p>Tá»« 4 chá»‰ sá»‘ nÃ y, ta cÃ³ 2 con sá»‘ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ tin cáº­y cá»§a má»™t mÃ´ hÃ¬nh:</p>

<h3 id="precision-and-recall">Precision and Recall</h3>

<ul>
  <li>Precision: Trong táº¥t cáº£ cÃ¡c dá»± Ä‘oÃ¡n Positive Ä‘Æ°á»£c Ä‘Æ°a ra, bao nhiÃªu dá»± Ä‘oÃ¡n lÃ  chÃ­nh xÃ¡c? Chá»‰ sá»‘ nÃ y Ä‘Æ°á»£c tÃ­nh theo cÃ´ng thá»©c</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>precision = TP  / (TP + FP)
</pre></td></tr></tbody></table></code></pre></div></div>
<ul>
  <li>Recall: Trong táº¥t cáº£ cÃ¡c trÆ°á»ng há»£p Positive, bao nhiÃªu trÆ°á»ng há»£p Ä‘Ã£ Ä‘Æ°á»£c dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c? Chá»‰ sá»‘ nÃ y Ä‘Æ°á»£c tÃ­nh theo cÃ´ng thá»©c:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>recall = TP  / (TP + FN)
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span>
<span class="n">precision_score</span><span class="p">(</span><span class="n">y_train_5</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
<span class="c1"># == 4096 / (4096 + 1522) 0.7290850836596654
</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_train_5</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
<span class="c1"># == 4096 / (4096 + 1325) 0.7555801512636044
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="f1-score">F1-SCORE</h3>

<p>Äá»ƒ káº¿t há»£p 2 chá»‰ sá»‘ nÃ y, ngÆ°á»i ta Ä‘Æ°a ra chá»‰ sá»‘ F1-score</p>

<p>Má»™t mÃ´ hÃ¬nh cÃ³ chá»‰ sá»‘ F-score cao chá»‰ khi cáº£ 2 chá»‰ sá»‘ Precision vÃ  Recall Ä‘á»ƒ cao. Má»™t trong 2 chá»‰ sá»‘ nÃ y tháº¥p Ä‘á»u sáº½ kÃ©o Ä‘iá»ƒm F-score xuá»‘ng. TrÆ°á»ng há»£p xáº¥u nháº¥t khi 1 trong hai chá»‰ sá»‘ Precison vÃ  Recall báº±ng 0 sáº½ kÃ©o Ä‘iá»ƒm F-score vá» 0. TrÆ°á»ng há»£p tá»‘t nháº¥t khi cáº£ Ä‘iá»ƒm chá»‰ sá»‘ Ä‘á»u Ä‘áº¡t giÃ¡ trá»‹ báº±ng 1, khi Ä‘Ã³ Ä‘iá»ƒm F-score sáº½ lÃ  1.</p>

<p>Äá»ƒ tÃ­nh F1-score, ta thá»±c hiá»‡n nhÆ° sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="n">f1_score</span><span class="p">(</span><span class="n">y_train_5</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
<span class="c1"># 0.7420962043663375
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>Tuy nhiÃªn thÃ¬ khÃ´ng pháº£i lÃºc nÃ o ta cÅ©ng cáº§n Ä‘áº¿n F1, 1 vÃ i trÆ°á»ng há»£p ta chá»‰ quan tÃ¢m Ä‘áº¿n precision, 1 vÃ i trÆ°á»ng há»£p ta quan tÃ¢m Ä‘áº¿n recall. VÃ­ dá»¥, náº¿u báº¡n huáº¥n luyá»‡n 1 mÃ´ hÃ¬nh Ä‘á»ƒ phÃ¡t hiá»‡n video an toÃ n cho tráº» em, báº¡n pháº£i sá»­ dá»¥ng bá»™ phÃ¢n lá»›p mÃ  cÃ³ thá»ƒ bá» sÃ³t nhiá»u video an toÃ n (recall tháº¥p) nhÆ°ng Ã­t bá» qua cÃ¡c video khÃ´ng an toÃ n (high precision). Hay cÃ²n gá»i lÃ  giáº¿t nháº§m cÃ²n hÆ¡n bá» sÃ³t, thÃ  khÃ´ng hiá»ƒn thá»‹ video an toÃ n cÃ²n hÆ¡n lÃ  hiá»ƒn thá»‹ video khÃ´ng an toÃ n.</p>

<h1 id="source-code">Source Code</h1>

<p>CÃ¡c báº¡n cÃ³ thá»ƒ xem táº¡i: <a href="https://github.com/dinhquy94/codecamp.vn/blob/master/bai3_4.ipynb">Github</a></p>

<h1 id="nguá»“n-tham-kháº£o">Nguá»“n tham kháº£o:</h1>

<ul>
  <li><a href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/">Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd Edition</a></li>
</ul>

:ET