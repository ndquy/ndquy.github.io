I"Ä}<p>Thuáº­t toÃ¡n phÃ¢n cá»¥m K-Means lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n phÃ¢n cá»¥m dá»¯ liá»‡u dá»±a trÃªn há»c khÃ´ng giÃ¡m sÃ¡t Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u trong cÃ¡c há»c mÃ¡y nÃ³i chung vÃ  trong khai phÃ¡ dá»¯ liá»‡u nÃ³i riÃªng.</p>
<h1 id="nháº¯c-láº¡i-vá»-há»c-cÃ³-giÃ¡m-sÃ¡t-vÃ -khÃ´ng-giÃ¡m-sÃ¡t">Nháº¯c láº¡i vá» há»c cÃ³ giÃ¡m sÃ¡t vÃ  khÃ´ng giÃ¡m sÃ¡t</h1>
<h2 id="há»c-cÃ³-giÃ¡m-sÃ¡t">Há»c cÃ³ giÃ¡m sÃ¡t</h2>
<p>Trong há»c mÃ¡y, lá»›p cÃ¡c thuáº­t toÃ¡n há»c cÃ³ giÃ¡m sÃ¡t Supervised learning lÃ  viá»‡c há»c cÃ¡c xÃ¡c Ä‘á»‹nh hÃ m y = f(x) tá»« táº­p dá»¯ liá»‡u huáº¥n luyá»‡n gá»“m $\{\{x_1, x_2, â€¦, x_N\}; \{y_1, y_2,â€¦, y_N\}\}$ sao cho $y_i â‰… f(x_i )$ vá»›i má»i i.<br />
Äá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y táº­p dá»¯ liá»‡u huáº¥n luyá»‡n gá»“m cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u trong Ä‘Ã³ má»—i Ä‘iá»ƒm dá»¯ liá»‡u cÃ³ chá»©a nhÃ£n tÆ°Æ¡ng á»©ng.</p>
<h2 id="há»c-khÃ´ng-giÃ¡m-sÃ¡t">Há»c khÃ´ng giÃ¡m sÃ¡t</h2>
<p>Há»c cÃ¡ch xÃ¡c Ä‘á»‹nh hÃ m y = f(x) tá»« táº­p dá»¯ liá»‡u huáº¥n luyá»‡n gá»“m $\{x_1, x_2, â€¦, x_N\}$. CÃ¡c dá»¯ liá»‡u trong táº­p dá»¯ liá»‡u dÃ¹ng Ä‘á»ƒ huáº¥n luyá»‡n khÃ´ng cÃ³ nhÃ£n.<br />
CÃ¡c thuáº­t toÃ¡n phÃ¢n cá»¥m dá»±a trÃªn táº­p dá»¯ liá»‡u chÃ­nh lÃ  cÃ¡ch xÃ¡c Ä‘á»‹nh cáº¥u trÃºc áº©n trong táº­p dá»¯ liá»‡u Ä‘Ã³.</p>

<h1 id="vÃ­-dá»¥-vá»-há»c-khÃ´ng-giÃ¡m-sÃ¡t">VÃ­ dá»¥ vá» há»c khÃ´ng giÃ¡m sÃ¡t</h1>

<p>Há»c khÃ´ng giÃ¡m sÃ¡t nháº±m phÃ¢n dá»¯ liá»‡u thÃ nh má»™t sá»‘ cá»¥m cho trÆ°á»›c. <br />
VÃ­ dá»¥ phá»• biáº¿n cho thuáº­t toÃ¡n nÃ y Ä‘Ã³ lÃ  viá»‡c phÃ¢n loáº¡i khÃ¡ch hÃ ng. <br />
Giáº£ sá»­ ta cÃ³ má»™t táº­p dá»¯ liá»‡u mua hÃ ng cá»§a cÃ¡c khÃ¡ch hÃ ng, ta cÃ³ thá»ƒ Ä‘Æ°a dá»¯ liá»‡u nÃ y vÃ o thuáº­t toÃ¡n phÃ¢n cá»¥m Ä‘á»ƒ tiáº¿n hÃ nh phÃ¢n loáº¡i khÃ¡ch hÃ ng. <br />
CÃ¡c khÃ¡ch hÃ ng cÃ³ nhá»¯ng Ä‘áº·c Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng vá» máº·t thÃ´ng tin hoáº·c dá»±a trÃªn lá»‹ch sá»­ mua hÃ ng, hÃ nh vi mua hÃ ng cÃ³ thá»ƒ phÃ¢n thÃ nh cÃ¡c loáº¡i khÃ¡ch hÃ ng khÃ¡c nhau.<br />
NÃ³i cÃ¡ch khÃ¡c má»—i loáº¡i khÃ¡ch hÃ ng sáº½ cÃ³ nhá»¯ng Ä‘áº·c Ä‘iá»ƒm chung giá»‘ng nhau, vÃ  nhá»¯ng Ä‘áº·c Ä‘iá»ƒm Ä‘Ã³ Ä‘Æ°á»£c phÃ¡t hiá»‡n thÃ´ng qua thuáº­t toÃ¡n phÃ¢n cá»¥m mÃ  chÃºng ta sáº½ nghiÃªn cá»©u ngay sau Ä‘Ã¢y.<br />
<img src="/assets/img/blog/k-means-example.png" alt="VÃ­ dá»¥ vá» K-Means" /><br />
<em>VÃ­ dá»¥ vá» K-means</em></p>

<p>NgoÃ i ra cÃ³ má»™t vÃ­ dá»¥ khÃ¡c mÃ  chÃºng ta cÅ©ng hay báº¯t gáº·p, Ä‘Ã³ lÃ  cÃ¡c máº¡ng xÃ£ há»™i luÃ´n tÃ¬m cÃ¡ch phÃ¢n cá»¥m nhá»¯ng ngÆ°á»i cÃ³ cÃ¹ng sá»Ÿ thÃ­ch, thÃ³i quen Ä‘á»ƒ Ä‘Æ°a ra nhá»¯ng gá»£i Ã½ káº¿t báº¡n hay tham gia má»™t nhÃ³m nÃ o Ä‘Ã³.<br />
Äá»ƒ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c nhá»¯ng ngÆ°á»i cÃ³ cÃ¡c Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng trong máº¡ng xÃ£ há»™i ta cáº§n má»™t thuáº­t toÃ¡n phÃ¢n cá»¥m.</p>

<h1 id="bÃ i-toÃ¡n-phÃ¢n-cá»¥m">BÃ i toÃ¡n phÃ¢n cá»¥m</h1>
<p>ChÃºng ta sáº½ xem xÃ©t láº§n lÆ°á»£t cÃ¡c ná»™i dung liÃªn quan Ä‘áº¿n bÃ i toÃ¡n phÃ¢n cá»¥m.</p>
<h2 id="khÃ¡i-quÃ¡t-bÃ i-toÃ¡n-phÃ¢n-cá»¥m">KhÃ¡i quÃ¡t bÃ i toÃ¡n phÃ¢n cá»¥m:</h2>
<ul>
  <li><strong>Äáº§u vÃ o</strong>: Táº­p dá»¯ liá»‡u khÃ´ng cÃ³ nhÃ£n</li>
  <li><strong>Äáº§u ra</strong>: CÃ¡c cá»¥m dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n chia</li>
</ul>

<p>NhÆ° váº­y má»¥c tiÃªu cá»§a bÃ i toÃ¡n phÃ¢n cá»¥m lÃ  nhá»¯ng cá»¥m dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¢n chia bá»Ÿi thuáº­t toÃ¡n. ChÃºng ta cÃ¹ng xem xÃ©t Ä‘áº·c Ä‘iá»ƒm cá»§a má»™t cá»¥m.</p>
<h2 id="má»™t-cá»¥m">Má»™t cá»¥m</h2>

<ul>
  <li><strong>Trong má»™t cá»¥m thÃ¬ cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u thuá»™c vá» cá»¥m Ä‘Ã³ pháº£i giá»‘ng nhau</strong> theo má»™t Ã½ nghÄ©a, viá»‡c xÃ¡c Ä‘á»‹nh <em>tháº¿ nÃ o lÃ  giá»‘ng nhau</em> quyáº¿t Ä‘á»‹nh Ä‘áº§u ra cá»§a thuáº­t toÃ¡n nÃ y. VÃ­ dá»¥ nhÆ° Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nhá»¯ng khÃ¡ch hÃ ng thuá»™c cÃ¹ng má»™t nhÃ³m thÃ¬ trÆ°á»›c tiÃªn ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh Ä‘á»‹nh nghÄ©a <em>tháº¿ nÃ o lÃ  giá»‘ng nhau</em>?<br />
Hai khÃ¡ch hÃ ng tÆ°Æ¡ng Ä‘á»“ng cÃ³ thá»ƒ Ä‘Æ°á»£c xem xÃ©t dá»±a trÃªn cÃ¡c tiÃªu chÃ­ khÃ¡c nhau, cÃ³ thá»ƒ dá»±a trÃªn sá»‘ láº§n mua hÃ ng, sá»‘ tiá»n mua hÃ ng, hay giá»›i tÃ­nh, Ä‘á»™ tuá»•iâ€¦</li>
  <li><strong>Hai cá»¥m dá»¯ liá»‡u lÃ  khÃ¡c nhau</strong>: Äiá»u nÃ y lÃ  cáº§n thiáº¿t vÃ¬ khi phÃ¢n cá»¥m cÃ¡c cá»¥m pháº£i lÃ  tÃ¡ch biá»‡t nhau hoÃ n toÃ n, khÃ´ng cÃ³ sá»± chá»“ng láº¥p 2 cá»¥m dá»¯ liá»‡u vá»›i nhau.<br />
<img src="/assets/img/blog/clusters.jpg" alt="Má»¥c tiÃªu bÃ i toÃ¡n phÃ¢n cá»¥m" /></li>
</ul>

<h2 id="má»™t-sá»‘-phÆ°Æ¡ng-phÃ¡p-phÃ¢n-cá»¥m-phá»•-biáº¿n">Má»™t sá»‘ phÆ°Æ¡ng phÃ¡p phÃ¢n cá»¥m phá»• biáº¿n</h2>

<ul>
  <li><strong>PhÃ¢n cá»¥m dá»±a trÃªn phÃ¢n vÃ¹ng</strong> (Partition-based clustering): ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p phá»• biáº¿n vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u trong cÃ¡c bÃ i toÃ¡n phÃ¢n cá»¥m. Má»¥c tiÃªu lÃ  phÃ¢n dá»¯ liá»‡u thÃ nh cÃ¡c phÃ¢n vÃ¹ng khÃ¡c nhau.</li>
  <li><strong>PhÃ¢n cá»¥m thá»© báº­c</strong> (Hierarchical clustering): NgoÃ i viá»‡c phÃ¢n thÃ nh cÃ¡c cá»¥m lá»›n, phÆ°Æ¡ng phÃ¡p nÃ y cÃ²n phÃ¢n cÃ¡c cá»¥m lá»›n thÃ nh nhá»¯ng cá»¥m nhá» hÆ¡n dÆ°á»›i dáº¡ng thá»© báº­c.</li>
  <li>MÃ´ hÃ¬nh há»—n há»£p (Mixture models)</li>
  <li>PhÃ¢n cá»¥m sÃ¢u (Deep clustering): Sá»­ dá»¥ng máº¡ng nÆ¡-ron há»c sÃ¢u Ä‘á»ƒ phÃ¢n cá»¥m.</li>
</ul>

<h2 id="Ä‘Ã¡nh-giÃ¡-cháº¥t-lÆ°á»£ng-mÃ´-hÃ¬nh-phÃ¢n-cá»¥m">ÄÃ¡nh giÃ¡ cháº¥t lÆ°á»£ng mÃ´ hÃ¬nh phÃ¢n cá»¥m</h2>

<p>Äá»ƒ Ä‘Ã¡nh giÃ¡ cháº¥t lÆ°á»£ng mÃ´ hÃ¬nh phÃ¢n cá»¥m ta cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ thÃ´ng qua má»™t sá»‘ phÆ°Æ¡ng phÃ¡p nhÆ° sau:</p>

<ul>
  <li>Khoáº£ng cÃ¡ch / sá»± khÃ¡c biá»‡t giá»¯a hai cá»¥m báº¥t ká»³ pháº£i lá»›n. (khoáº£ng cÃ¡ch giá»¯a cÃ¡c cá»¥m): Giá»¯a cÃ¡c cá»¥m pháº£i Ä‘Æ°á»£c tÃ¡ch biá»‡t nhau hoÃ n toÃ n vÃ  sá»± khÃ¡c biá»‡t giá»¯a 2 cá»¥m pháº£i Ä‘á»§ lá»›n Ä‘á»ƒ phÃ¢n biá»‡t 2 cá»¥m vá»›i nhau.</li>
  <li>ChÃªnh lá»‡ch giá»¯a cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u bÃªn trong má»™t cá»¥m pháº£i nhá». ChÃªnh lá»‡ch á»Ÿ Ä‘Ã¢y thá»ƒ hiá»‡n sá»± khÃ¡c biá»‡t vá»›i nhau vá» máº·t  tÆ°Æ¡ng Ä‘á»“ng giá»¯a 2 dá»¯ liá»‡u theo tiÃªu chÃ­ phÃ¢n cá»¥m.</li>
</ul>

<h1 id="thuáº­t-toÃ¡n-phÃ¢n-cá»¥m-k-means">Thuáº­t toÃ¡n phÃ¢n cá»¥m K-means</h1>

<p>Thuáº­t toÃ¡n phÃ¢n cá»¥m K-means Ä‘Æ°á»£c giá»›i thiá»‡u nÄƒm 1957 bá»Ÿi Lloyd K-means vÃ  lÃ  phÆ°Æ¡ng phÃ¡p phá»• biáº¿n nháº¥t cho viá»‡c phÃ¢n cá»¥m, dá»±a trÃªn viá»‡c phÃ¢n vÃ¹ng dá»¯ liá»‡u <br />
Biá»ƒu diá»…n dá»¯ liá»‡u: $D = \{x_1, x_2, â€¦, x_r \}$, vá»›i $x_i$ lÃ  vector n chiá»u trong khÃ´ng gian Euclidean. K-means phÃ¢n cá»¥m D thÃ nh K cá»¥m dá»¯ liá»‡u:</p>
<ul>
  <li>Má»—i cá»¥m dá»¯ liá»‡u cÃ³ má»™t Ä‘iá»ƒm trung tÃ¢m gá»i lÃ  centroid.</li>
  <li>K lÃ  má»™t háº±ng sá»‘ cho trÆ°á»›c.</li>
</ul>

<h2 id="cÃ¡c-bÆ°á»›c-trong-thuáº­t-toÃ¡n-k-means">CÃ¡c bÆ°á»›c trong thuáº­t toÃ¡n K-Means</h2>

<ul>
  <li><strong>Äáº§u vÃ o</strong>: Cho táº­p dá»¯ liá»‡u D, vá»›i K lÃ  sá»‘ cá»¥m, phÃ©p Ä‘o khoáº£ng cÃ¡ch giá»¯a 2 Ä‘iá»ƒm dá»¯ liá»‡u lÃ  d(x,y)</li>
  <li><strong>Khá»Ÿi táº¡o</strong>: Khá»Ÿi táº¡o K Ä‘iá»ƒm dá»¯ liá»‡u trong D lÃ m cÃ¡c Ä‘iá»ƒm trung tÃ¢m (centroid)</li>
  <li><strong>Láº·p láº¡i</strong> cÃ¡c bÆ°á»›c sau Ä‘áº¿n khi <strong>há»™i tá»¥</strong>:
    <ul>
      <li><strong><em>BÆ°á»›c 1</em></strong>: Vá»›i má»—i Ä‘iá»ƒm dá»¯ liá»‡u, gÃ¡n Ä‘iá»ƒm dá»¯ liá»‡u Ä‘Ã³ vÃ o cluster cÃ³ khoáº£ng cÃ¡ch Ä‘áº¿n Ä‘iá»ƒm trung tÃ¢m cá»§a cluster lÃ  nhá» nháº¥t.</li>
      <li><strong><em>BÆ°á»›c 2:</em></strong> Vá»›i má»—i cluster, xÃ¡c Ä‘á»‹nh láº¡i Ä‘iá»ƒm trung tÃ¢m cá»§a táº¥t cáº£ cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘Æ°á»£c gÃ¡n vÃ o cluster Ä‘Ã³.</li>
    </ul>
  </li>
</ul>

<p>Sau Ä‘Ã¢y lÃ  má»™t sá»‘ bÆ°á»›c dÆ°á»›i dáº¡ng hÃ¬nh áº£nh:<br />
<img src="/assets/img/blog/k-mean-step1.jpg" alt="Thuáº­t toÃ¡n k-means" /><br />
Táº¡i bÆ°á»›c nÃ y thuáº­t toÃ¡n sáº½ khá»Ÿi táº¡o <strong>k</strong> Ä‘iá»ƒm dá»¯ liá»‡u trung tÃ¢m ban Ä‘áº§u, sau Ä‘Ã³ qua iteration 1 Ä‘á»ƒ thá»±c hiá»‡n bÆ°á»›c 1: gÃ¡n cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u vÃ o cluster vÃ  bÆ°á»›c 2: XÃ¡c Ä‘á»‹nh láº¡i Ä‘iá»ƒm trung tÃ¢m.<br />
<img src="/assets/img/blog/k-mean-step2.jpg" alt="Thuáº­t toÃ¡n k-means" /><br />
CÃ¡c vÃ²ng láº·p iteration 2 vÃ  iteration 3 tiáº¿p tá»¥c thá»±c hiá»‡n nhÆ° váº­y Ä‘áº¿n khi nÃ o thuáº­t toÃ¡n há»™i tá»¥ thÃ¬ dá»«ng láº¡i.</p>

<h2 id="Ä‘iá»u-kiá»‡n-há»™i-tá»¥-Ä‘iá»u-kiá»‡n-dá»«ng-thuáº­t-toÃ¡n">Äiá»u kiá»‡n há»™i tá»¥ (Ä‘iá»u kiá»‡n dá»«ng thuáº­t toÃ¡n)</h2>

<p>Ta sáº½ xÃ¡c Ä‘á»‹nh Ä‘iá»u kiá»‡n dá»«ng thuáº­t toÃ¡n theo má»™t sá»‘ cÃ¡ch nhÆ° sau:</p>
<ul>
  <li>Táº¡i 1 vÃ²ng láº·p: cÃ³ Ã­t cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘Æ°á»£c gÃ¡n sang cluster khÃ¡c hoáº·c</li>
  <li>Äiá»ƒm trung tÃ¢m (centroid) khÃ´ng thay Ä‘á»•i nhiá»u hoáº·c</li>
  <li>GiÃ¡ trá»‹ hÃ m máº¥t mÃ¡t khÃ´ng thay Ä‘á»•i nhiá»u:<br />
<img src="/assets/img/blog/k-mean-loss.jpg" alt="Thuáº­t toÃ¡n k-means" /></li>
</ul>

<p>Trong Ä‘Ã³ $C_i$ lÃ  cluster thá»© i, $m_i$ lÃ  Ä‘iá»ƒm trung tÃ¢m cá»§a cluster $C_i$ tÆ°Æ¡ng á»©ng.</p>

<p>NhÃ¬n chung vá» Ä‘iá»u kiá»‡n há»™i tá»¥ cÃ³ thá»ƒ tháº¥y má»‘i liÃªn há»‡ giá»¯a cÃ¡c Ä‘iá»u kiá»‡n lÃ  gáº§n tÆ°Æ¡ng Ä‘á»“ng nhÆ° nhau. Khi cÃ³ Ã­t Ä‘iá»ƒm dá»¯ liá»‡u Ä‘Æ°á»£c gÃ¡n sang cluster khÃ¡c cÃ³ thá»ƒ khiáº¿n Ä‘iá»ƒm trung tÃ¢m khÃ´ng thay Ä‘á»•i nhiá»u vÃ  tá»« Ä‘Ã³ hÃ m máº¥t mÃ¡t cÅ©ng sáº½ Ã­t bá»‹ áº£nh hÆ°á»Ÿng. Váº­y nÃªn chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng 1 trong 3 cÃ¡ch trÃªn Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘iá»u kiá»‡n dá»«ng cá»§a thuáº­t toÃ¡n.</p>

<h2 id="xÃ¡c-Ä‘á»‹nh-Ä‘iá»ƒm-trung-tÃ¢m-cá»§a-cluster">XÃ¡c Ä‘á»‹nh Ä‘iá»ƒm trung tÃ¢m cá»§a cluster</h2>

<p>Äá»ƒ xÃ¡c Ä‘á»‹nh Ä‘iá»ƒm trung tÃ¢m cá»§a cluster ta sá»­ dá»¥ng cÃ´ng thá»©c nhÆ° sau:<br />
<img src="/assets/img/blog/k-mean-center_calculate.jpg" alt="Thuáº­t toÃ¡n k-means" /></p>

<p>Trong Ä‘Ã³ $C_i$ lÃ  cluster thá»© i, $m_i$ lÃ  Ä‘iá»ƒm trung tÃ¢m cá»§a cluster $C_i$ tÆ°Æ¡ng á»©ng.</p>

<h2 id="phÃ©p-Ä‘o-khoáº£ng-cÃ¡ch">PhÃ©p Ä‘o khoáº£ng cÃ¡ch</h2>

<p>Trong K-means Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ giá»‘ng nhau hay khoáº£ng cÃ¡ch giá»¯a 2 Ä‘iá»ƒm dá»¯ liá»‡u ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c phÃ©p Ä‘o khoáº£ng cÃ¡ch khÃ¡c nhau. NgoÃ i khoáº£ng cÃ¡ch Euclidean, tuá»³ thuá»™c vÃ o tá»«ng bÃ i toÃ¡n cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Ä‘o khÃ¡c (cosine, manhattanâ€¦)</p>

<p><img src="/assets/img/blog/euclid.jpg" alt="Thuáº­t toÃ¡n k-means - PhÃ©p Ä‘o euclid" /></p>

<p>Má»i phÆ°Æ¡ng phÃ¡p tÃ­nh khoáº£ng cÃ¡ch giá»¯a 2 vector Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng. Má»—i cÃ¡ch tÃ­nh khoáº£ng cÃ¡ch thá»ƒ hiá»‡n cÃ¡ch nhÃ¬n nháº­n vá» dá»¯ liá»‡u</p>
<ul>
  <li>CÃ³ vÃ´ sá»‘ cÃ¡ch tÃ­nh khoáº£ng cÃ¡ch</li>
  <li>CÃ¡ch tÃ­nh khoáº£ng cÃ¡ch nÃ o lÃ  tá»‘t? CÃ¢u tráº£ lá»i phá»¥ thuá»™c vÃ o tá»«ng bÃ i toÃ¡n Ä‘á»ƒ Ä‘Æ°a ra cÃ¡ch tÃ­nh khoáº£ng cÃ¡ch phÃ¹ há»£p.</li>
</ul>

<h1 id="má»™t-sá»‘-áº£nh-hÆ°á»Ÿng-Ä‘áº¿n-thuáº­t-toÃ¡n-k-means">Má»™t sá»‘ áº£nh hÆ°á»Ÿng Ä‘áº¿n thuáº­t toÃ¡n K-means</h1>
<p>ChÃºng ta sáº½ cÃ¹ng nhau xem xÃ©t má»™t sá»‘ áº£nh hÆ°á»Ÿng Ä‘áº¿n thuáº­t toÃ¡n K-means vÃ  phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ xá»­ lÃ½.</p>
<h2 id="áº£nh-hÆ°á»Ÿng-cá»§a-outlier">áº¢nh hÆ°á»Ÿng cá»§a outlier</h2>
<h3 id="outlier-lÃ -gÃ¬">Outlier lÃ  gÃ¬?</h3>
<p>Hiá»ƒu Ä‘Æ¡n giáº£n thÃ¬ Outliers lÃ  má»™t hoáº·c nhiá»u cÃ¡ thá»ƒ khÃ¡c háº³n Ä‘á»‘i vá»›i cÃ¡c thÃ nh viÃªn cÃ²n láº¡i cá»§a nhÃ³m. Sá»± khÃ¡c biá»‡t nÃ y cÃ³ thá»ƒ dá»±a trÃªn nhiá»u tiÃªu chÃ­ khÃ¡c nhau nhÆ° giÃ¡ trá»‹ hay thuá»™c tÃ­nh. VÃ­ dá»¥ vá» outlier cÃ³ thá»ƒ nhÆ° lÃ  nhiá»…u trong cÃ¡c cáº£m biáº¿n hay lá»—i trong quÃ¡ trÃ¬nh nháº­p liá»‡u cá»§a ngÆ°á»i dÃ¹ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cháº¥t lÆ°á»£ng cá»§a dá»¯ liá»‡u.</p>
<h3 id="xem-xÃ©t-áº£nh-hÆ°á»ng">Xem xÃ©t áº£nh hÆ°á»ng</h3>
<p>K-means nháº¡y cáº£m vá»›i cÃ¡c Ä‘iá»ƒm outlier, vÃ­ dá»¥: CÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u outlier áº£nh hÆ°á»Ÿng lá»›n Ä‘áº¿n káº¿t quáº£ cá»§a viá»‡c phÃ¢n cá»¥m:</p>
<ul>
  <li>CÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u outlier cÃ³ khoáº£ng cÃ¡ch Ä‘áº¿n cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u chuáº©n ráº¥t lá»›n.</li>
  <li>PhÃ¢n bá»‘ cá»§a cÃ¡c Ä‘iá»ƒm outliner ráº¥t khÃ¡c so vá»›i cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u chuáº©n</li>
  <li>Nhiá»…u hoáº·c lá»—i cá»§a dá»¯ liá»‡u Ä‘Æ°á»£c thá»ƒ hiá»‡n trong cÃ¡c Ä‘iá»ƒm outlier</li>
</ul>

<p><img src="/assets/img/blog/oulier.jpg" alt="Thuáº­t toÃ¡n k-means - VÃ­ dá»¥ vá» oulier" /></p>

<h3 id="kháº¯c-phá»¥c-outlier">Kháº¯c phá»¥c outlier</h3>

<ul>
  <li><strong>Outlier removal</strong>: CÃ³ thá»ƒ loáº¡i bá» cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u xa Ä‘Ã¡ng ká»ƒ so vá»›i Ä‘iá»ƒm trung tÃ¢m (centroid) cá»§a cÃ¡c cluster so vá»›i cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u khÃ¡c.  Viá»‡c loáº¡i bá» cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n trÆ°á»›c hoáº·c trong khi phÃ¢n cá»¥m.</li>
  <li><strong>Random sampling</strong>: Thay vÃ¬ phÃ¢n cá»¥m toÃ n bá»™ táº­p dá»¯ liá»‡u, chÃºng ta sáº½ láº¥y ngáº«u nhiÃªn táº­p con S tá»« táº­p dá»¯ liá»‡u huáº¥n luyá»‡n. S Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n cá»¥m, táº­p S lÃºc nÃ y sáº½ cÃ³ Ã­t cÃ¡c Ä‘iá»ƒm outlier hÆ¡n táº­p dá»¯ liá»‡u gá»‘c. Sau khi phÃ¢n cá»¥m xong, táº­p dá»¯ liá»‡u cÃ²n láº¡i sáº½ Ä‘Æ°á»£c gÃ¡n vÃ o cÃ¡c cá»¥m Ä‘Ã£ há»c Ä‘Æ°á»£c</li>
</ul>

<h2 id="áº£nh-hÆ°á»Ÿng-cá»§a-viá»‡c-khá»Ÿi-táº¡o-trung-tÃ¢m">áº¢nh hÆ°á»Ÿng cá»§a viá»‡c khá»Ÿi táº¡o trung tÃ¢m</h2>

<p>Cháº¥t lÆ°á»£ng cá»§a K-means phá»¥ thuá»™c vÃ o viá»‡c khá»Ÿi táº¡o cÃ¡c Ä‘iá»ƒm centroid<br />
<img src="/assets/img/blog/k-mean-problem1.jpg" alt="Thuáº­t toÃ¡n k-means " /></p>

<p><strong>Giáº£i phÃ¡p 1</strong>: Láº·p láº¡i nhiá»u láº§n thuáº­t toÃ¡n K-means:</p>
<ul>
  <li>Má»—i láº§n cháº¡y láº¡i thuáº­t toÃ¡n K-means sáº½ khá»Ÿi táº¡o cÃ¡c Ä‘iá»ƒm centroid khÃ¡c nhau</li>
  <li>Sau quÃ¡ trÃ¬nh há»c, tiáº¿n hÃ nh gá»™p cÃ¡c káº¿t quáº£ tá»« cÃ¡c láº§n cháº¡y thÃ nh káº¿t quáº£ cuá»‘i cÃ¹ng</li>
</ul>

<p><strong>Giáº£i phÃ¡p 2</strong>: Thuáº­t toÃ¡n K-means++ : Äá»ƒ tÃ¬m ra cá»¥m tá»‘t nháº¥t, chÃºng ta cÃ³ thá»ƒ láº§n lÆ°á»£t khá»Ÿi táº¡i cÃ¡c Ä‘iá»ƒm trung tÃ¢m tá»« táº­p D tuáº§n tá»± nhÆ° sau:</p>
<ul>
  <li>Láº¥y ngáº«u nhiÃªn Ä‘iá»ƒm centroid Ä‘áº§u tiÃªn m1</li>
  <li>Láº¥y Ä‘iá»ƒm centroid tiáº¿p theo lÃ  Ä‘iá»ƒm xa nháº¥t so vá»›i m1</li>
  <li>..</li>
  <li>Láº¥y Ä‘iá»ƒm centroid thá»© i $(m_i)$ lÃ  Ä‘iá»ƒm xa nháº¥t so vá»›i $\{ m_1,â€¦, m_i-1\}$</li>
  <li>â€¦</li>
  <li>Báº±ng cÃ¡ch nÃ y K-means sáº½ há»™i tá»¥ vá» gáº§n káº¿t quáº£ tá»‘i Æ°u (Arthur, D.; Vassilvitskii, 2007)</li>
</ul>

<h1 id="tá»•ng-káº¿t">Tá»•ng káº¿t</h1>
<h2 id="Æ°u-Ä‘iá»ƒm-cá»§a-thuáº­t-toÃ¡n-k-means">Æ¯u Ä‘iá»ƒm cá»§a thuáº­t toÃ¡n K-means:</h2>
<p>*ÄÆ¡n giáº£n</p>
<ul>
  <li>Hiá»‡u quáº£ trong thá»±c táº¿</li>
  <li>Äáº£m báº£o há»™i tá»¥ trong thá»i gian Ä‘a thá»©c [Manthey &amp; RÃ¶glin, JACM, 2011]</li>
  <li>Linh hoáº¡t trong viá»‡c lá»±a chá»n phÆ°Æ¡ng phÃ¡p Ä‘o khoáº£ng cÃ¡ch
    <h2 id="háº¡n-cháº¿">Háº¡n cháº¿:</h2>
  </li>
  <li>Viá»‡c lá»±a chá»n cÃ¡c tÃ­nh khoáº£ng cÃ¡ch cho bÃ i toÃ¡n cá»¥ thá»ƒ khÃ³.</li>
  <li>Nháº¡y cáº£m vá»›i cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u outlier</li>
</ul>

<h1 id="code-python">Code Python</h1>

<p>Load cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Khá»Ÿi táº¡o dá»¯ liá»‡u demo</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1"># Khá»Ÿi táº¡o dá»¯ liá»‡u demo
</span><span class="n">means</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>  <span class="p">[</span><span class="mi">9</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>  <span class="p">[</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">6</span><span class="p">]]</span>
<span class="n">cov</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]]</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cov</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cov</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="nb">object</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cov</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">original_label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">).</span><span class="n">T</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">kmeans_display</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">amax</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">X0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">X1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">X2</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X0</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'b^'</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="p">.</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="p">.</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'rs'</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="p">.</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">kmeans_display</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">original_label</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/assets/img/blog/kmeansimplement.png" alt="Thuáº­t toÃ¡n k-means " />
<em>Biá»ƒu diá»…n dá»¯ liá»‡u demo</em></p>

<p>XÃ¢y dá»±ng cÃ¡c hÃ m cáº§n thiáº¿t</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">init_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="c1"># pick k centroid randomly
</span>    <span class="k">return</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">assign_labels</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
  <span class="n">clusters</span> <span class="o">=</span> <span class="p">{}</span> 
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="n">clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">featureset</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span> 
    <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">featureset</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">)</span> <span class="k">for</span> <span class="n">centroid</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">]</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">distances</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
    <span class="n">clusters</span><span class="p">[</span><span class="n">cluster</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">featureset</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">clusters</span>
  
<span class="k">def</span> <span class="nf">update_centroids</span><span class="p">(</span><span class="n">clusters</span><span class="p">):</span>
  <span class="n">new_centroids</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">data_points</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">new_centroids</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">average</span><span class="p">(</span><span class="n">data_points</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">new_centroids</span>

<span class="k">def</span> <span class="nf">has_converged</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">):</span>
    <span class="c1"># return True if two sets of centers are the same
</span>    <span class="k">return</span> <span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">centers</span><span class="p">])</span> <span class="o">==</span> 
        <span class="nb">set</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">new_centers</span><span class="p">]))</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Pháº§n code triá»ƒn khai thuáº­t toÃ¡n</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span> 
<span class="n">centroids</span> <span class="o">=</span> <span class="n">init_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
  <span class="n">clusters</span> <span class="o">=</span> <span class="n">assign_labels</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
  <span class="n">new_centroids</span> <span class="o">=</span> <span class="n">update_centroids</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">has_converged</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="n">new_centroids</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'convered'</span><span class="p">)</span>
    <span class="k">break</span>
  <span class="n">centroids</span> <span class="o">=</span> <span class="n">new_centroids</span>

<span class="n">X_</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">datapoints</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">datapoint</span> <span class="ow">in</span> <span class="n">datapoints</span><span class="p">:</span>
    <span class="n">X_</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">datapoint</span><span class="p">)</span>
    <span class="n">labels</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Hiá»ƒn thá»‹ káº¿t quáº£</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">kmeans_display</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Káº¿t quáº£ thuáº­t toÃ¡n</p>

<p><img src="/assets/img/blog/kmeansimplement2.png" alt="Thuáº­t toÃ¡n k-means " />
<em>Biá»ƒu diá»…n káº¿t quáº£ phÃ¢n cá»¥m cá»§a thuáº­t toÃ¡n</em></p>
:ET