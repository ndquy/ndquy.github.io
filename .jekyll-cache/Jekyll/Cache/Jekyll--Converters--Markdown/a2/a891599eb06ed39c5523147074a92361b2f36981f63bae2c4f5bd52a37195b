I"úß<h1 id="má»¥c-tiÃªu-bÃ i-viáº¿t">Má»¥c tiÃªu bÃ i viáº¿t</h1>

<p>PhÃ¢n tÃ­ch cÃ¢u há»i lÃ  pha Ä‘áº§u tiÃªn trong kiáº¿n trÃºc chung cá»§a má»™t há»‡ thá»‘ng há»i Ä‘Ã¡p, cÃ³
nhiá»‡m vá»¥ tÃ¬m ra cÃ¡c thÃ´ng tin cáº§n thiáº¿t lÃ m Ä‘áº§u vÃ o cho quÃ¡ trÃ¬nh xá»­ lÃ½ cá»§a cÃ¡c pha sau
(trÃ­ch chá»n tÃ i liá»‡u, trÃ­ch xuáº¥t cÃ¢u tráº£ lá»i, â€¦). VÃ¬ váº­y phÃ¢n tÃ­ch cÃ¢u há»i cÃ³ vai trÃ² háº¿t sá»©c
quan trá»ng, áº£nh hÆ°á»Ÿng trá»±c tiáº¿p Ä‘áº¿n hoáº¡t Ä‘á»™ng cá»§a toÃ n bá»™ há»‡ thá»‘ng. Náº¿u phÃ¢n tÃ­ch cÃ¢u há»i khÃ´ng tá»‘t thÃ¬ sáº½ khÃ´ng thá»ƒ tÃ¬m ra Ä‘Æ°á»£c cÃ¢u tráº£ lá»i.</p>

<p>HÃ´m nay mÃ¬nh sáº½ trÃ¬nh bÃ y vá» cÃ¡c phÆ°Æ¡ng phÃ¡p phÃ¢n loáº¡i Ã½ Ä‘á»‹nh cá»§a ngÆ°á»i há»i trong há»‡ thá»‘ng há»i Ä‘Ã¡p dá»±a trÃªn táº­p dá»¯ liá»‡u lÃ  cÃ¡c cÃ¢u há»i cá»§a sinh viÃªn trÆ°á»ng Äáº¡i há»c XÃ¢y dá»±ng. 
Trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng mÃ¬nh Ä‘Ã£ thá»­ nghiá»‡m nhiá»u phÆ°Æ¡ng phÃ¡p khÃ¡c nhau, tuy nhiÃªn vá»›i pháº¡m vi blog nÃ y mÃ¬nh sáº½ chia sáº» má»™t phÆ°Æ¡ng phÃ¡p tá»‘t nháº¥t mÃ  mÃ¬nh Ä‘Ã£ sá»­ dá»¥ng, cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c mÃ¬nh sáº½ chia sáº» dáº§n trong cÃ¡c bÃ i viáº¿t tiáº¿p theo.</p>

<h1 id="xÃ¡c-Ä‘á»‹nh-Ã½-Ä‘á»‹nh-lÃ -gÃ¬">XÃ¡c Ä‘á»‹nh Ã½ Ä‘á»‹nh lÃ  gÃ¬?</h1>

<p>Äá»‘i vá»›i há»‡ thá»‘ng há»i Ä‘Ã¡p, phÃ¢n loáº¡i Ã½ Ä‘á»‹nh (intent classification) lÃ  viá»‡c xÃ¡c Ä‘á»‹nh Ã½ Ä‘á»‹nh cá»§a ngÆ°á»i há»i khi tÆ°Æ¡ng tÃ¡c vá»›i há»‡ thá»‘ng thÃ´ng qua cÃ¢u há»i hay cÃ¢u truy váº¥n cá»§a ngÆ°á»i dÃ¹ng.
VÃ­ dá»¥ Ä‘á»‘i vá»›i cÃ¢u há»i: â€œCho mÃ¬nh há»i Ä‘á»‹a chá»‰ cÆ¡ sá»Ÿ A á»Ÿ Ä‘Ã¢u áº¡?â€, thÃ¬ Ã½ Ä‘á»‹nh cá»§a ngÆ°á»i dÃ¹ng lÃ  há» Ä‘ang muá»‘n há»i vá» â€˜ADDRESSâ€™, 
vÃ­ dá»¥ khÃ¡c nhÆ° cÃ¢u há»i : â€œThá»i gian má»Ÿ cá»­a cá»§a cá»­a hÃ ng lÃ  máº¥y giá»?â€ thÃ¬ Ã½ Ä‘á»‹nh cá»§a ngÆ°á»i dÃ¹ng lÃ  há»i vá» â€˜TIMEâ€™. 
Dá»±a vÃ o viá»‡c xÃ¡c Ä‘á»‹nh Ã½ Ä‘á»‹nh sáº½ giÃºp viá»‡c tráº£ lá»i cÃ¢u há»i Ä‘Æ°á»£c chÃ­nh xÃ¡c vÃ  Ä‘Æ°a ra Ä‘Æ°á»£c cÃ¢u tráº£ lá»i mong muá»‘n cá»§a ngÆ°á»i dÃ¹ng.</p>

<h1 id="cÃ¡c-phÆ°Æ¡ng-phÃ¡p-xÃ¡c-Ä‘á»‹nh-Ã½-Ä‘á»‹nh">CÃ¡c phÆ°Æ¡ng phÃ¡p xÃ¡c Ä‘á»‹nh Ã½ Ä‘á»‹nh</h1>

<p>Äá»‘i vá»›i cÃ¡c bÃ i toÃ¡n cáº§n xÃ¡c Ä‘á»‹nh Ã½ Ä‘á»‹nh, cÃ³ nhiá»u phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ thá»±c hiá»‡n.</p>
<h2 id="hÆ°á»›ng-tiáº¿p-cáº­n-nÃ´ng-shalow">HÆ°á»›ng tiáº¿p cáº­n nÃ´ng (shalow)</h2>
<p>PhÆ°Æ¡ng phÃ¡p cá»• Ä‘iá»ƒn lÃ  dá»±a trÃªn táº§n suáº¥t xuáº¥t hiá»‡n vÃ  má»©c Ä‘á»™ quan trá»ng cÃ¡c tá»« trong cÃ¡c Ã½ Ä‘á»‹nh Ä‘Ã£ biáº¿t hay cÃ²n gá»i lÃ  hÆ°á»›ng tiáº¿p cáº­n nÃ´ng. VÃ­ dá»¥ Ä‘á»ƒ há»i vá» thá»i gian thÃ¬ trong cÃ¢u há»i sáº½ hay xuáº¥t hiá»‡n cÃ¡c tá»« nhÆ° â€œmáº¥y giá»â€, â€œngÃ y nÃ oâ€, â€œthÃ¡ng nÃ oâ€, â€œnÄƒm nÃ oâ€,â€¦
CÃ²n Ã½ Ä‘á»‹nh muá»‘n há»i vá» Ä‘á»‹a Ä‘iá»ƒm thÃ¬ sáº½ cÃ³ cÃ¡c tá»«: â€œá»Ÿ Ä‘Ã¢uâ€, â€œÄ‘á»‹a chá»‰â€, â€œchá»— nÃ oâ€,..v.v.
Nhiá»u phÆ°Æ¡ng phÃ¡p sá»­ dá»¥ng trong Q&amp;A dÃ¹ng cÃ¡c kÄ©
thuáº­t dá»±a trÃªn tá»« khÃ³a Ä‘á»ƒ Ä‘á»‹nh vá»‹ cÃ¡c cÃ¢u, Ä‘á»an vÄƒn cÃ³ kháº£ nÄƒng chá»©a cÃ¢u tráº£ lá»i tá»« cÃ¡c
vÄƒn báº£n Ä‘Æ°á»£c trÃ­ch chá»n vá». Sau Ä‘Ã³ giá»¯ láº¡i cÃ¡c cÃ¢u, Ä‘oáº¡n vÄƒn cÃ³ chá»©a chuá»—i kÃ½ tá»± cÃ¹ng
loáº¡i vá»›i loáº¡i cÃ¢u tráº£ lá»i mong muá»‘n (vÃ­ dá»¥ cÃ¡c cÃ¢u há»i vá» tÃªn ngÆ°á»i, Ä‘á»‹a danh, sá»‘
lÆ°á»£ngâ€¦).</p>

<p>Khi xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c cÃ¡c tá»« hay xuáº¥t hiá»‡n trong cÃ¡c Ã½ Ä‘á»‹nh thÃ¬ tÃ¹y vÃ o xÃ¡c suáº¥t xuáº¥t hiá»‡n cá»§a cÃ¡c tá»« trong cÃ¢u há»i mÃ  chÃºng ta sáº½ dá»± Ä‘oÃ¡n Ä‘Æ°á»£c kháº£ nÄƒng Ã½ Ä‘á»‹nh cá»§a ngÆ°á»i dÃ¹ng sáº½ thuá»™c vÃ o loáº¡i nÃ o.
Tuy nhiÃªn viá»‡c xÃ¡c Ä‘á»‹nh dá»±a trÃªn tá»« Ä‘iá»ƒn nhÆ° váº­y sáº½ khÃ´ng Ä‘áº§y Ä‘á»§ vÃ  thiáº¿u chÃ­nh xÃ¡c. NgÃ´n ngá»¯ tá»± nhiÃªn lÃ  ngÃ´n ngá»¯ cÃ³ tÃ­nh nháº­p nháº±ng, vÃ¬ váº­y nÃªn má»™t sá»‘ cÃ¢u há»i náº¿u dá»±a vÃ o nhá»¯ng tá»« nhÆ° váº­y chÆ°a cháº¯c Ä‘Ã£ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c Ã½ Ä‘á»‹nh cÃ¢u há»i.</p>

<h2 id="hÆ°á»›ng-tiáº¿p-cáº­n-sÃ¢u-deep">HÆ°á»›ng tiáº¿p cáº­n sÃ¢u (deep)</h2>

<p>Trong nhá»¯ng trÆ°á»ng há»£p khi mÃ  hÆ°á»›ng tiáº¿p cáº­n bá» máº·t
khÃ´ng thá»ƒ tÃ¬m ra cÃ¢u tráº£ lá»i, nhá»¯ng quÃ¡ trÃ¬nh xá»­ lÃ½ vá» ngá»¯ phÃ¡p, ngá»¯ nghÄ©a vÃ  ngá»¯ cáº£nh lÃ 
cáº§n thiáº¿t Ä‘á»ƒ trÃ­ch xuáº¥t hoáº·c táº¡o ra cÃ¢u tráº£ lá»i. CÃ¡c kÄ© thuáº­t thÆ°á»ng dÃ¹ng nhÆ° nháº­n dáº¡ng
thá»±c thá»ƒ (named-entity recognition), trÃ­ch xuáº¥t má»‘i quan há»‡, loáº¡i bá» nháº­p nháº±ng ngá»¯
nghÄ©a,â€¦ Há»‡ thá»‘ng thÆ°á»ng sá»­ dá»¥ng cÃ¡c nguá»“n tri thá»©c nhÆ° Wordnet, ontology Ä‘á»ƒ lÃ m giÃ u
thÃªm kháº£ nÄƒng láº­p luáº­n thÃ´ng qua cÃ¡c Ä‘á»‹nh nghÄ©a vÃ  má»‘i liÃªn há»‡ ngá»¯ nghÄ©a. CÃ¡c há»‡ thá»‘ng
há»i Ä‘Ã¡p dá»±a theo mÃ´ hÃ¬nh ngÃ´n ngá»¯ thá»‘ng kÃª cÅ©ng Ä‘ang ngÃ y cÃ ng phá»• biáº¿n.</p>

<p>Trong bÃ i viáº¿t nÃ y mÃ¬nh sáº½ tiáº¿p cáº­n theo hÆ°á»›ng tiáº¿p cáº­n sÃ¢u.</p>

<h1 id="dá»¯-liá»‡u-sá»­-dá»¥ng">Dá»¯ liá»‡u sá»­ dá»¥ng</h1>

<p>Äá»ƒ xÃ¢y dá»±ng mÃ´ hÃ¬nh xÃ¡c Ä‘á»‹nh Ã½ Ä‘á»‹nh cÃ¢u há»i, mÃ¬nh sáº½ sá»­ dá»¥ng ontology lÃ  cÃ¡c cáº·p â€œcÃ¢u há»i - Ã½ Ä‘á»‹nhâ€ Ä‘Æ°á»£c thu tháº­p tá»« sinh viÃªn trÆ°á»ng Äáº¡i há»c XÃ¢y dá»±ng.
MÃ¬nh sáº½ Ä‘Æ°a bÃ i toÃ¡n vá» viá»‡c xÃ¢y dá»±ng má»™t mÃ´ hÃ¬nh phÃ¢n lá»›p vá»›i cÃ¡c class lÃ  cÃ¡c Ã½ Ä‘á»‹nh cá»§a ngÆ°á»i há»i. VÃ­ dá»¥ sau Ä‘Ã¢y lÃ  cÃ¡c cÃ¢u há»i trong táº­p dá»¯ liá»‡u:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>{'content': 'thÆ°a tháº§y cÃ´, báº£ng Ä‘iá»ƒm cá»§a em hiá»‡n táº¡i giá» Ä‘Æ°á»£c 1 mÃ´n C+ 2 tÃ­n chá»‰, 2 mÃ´n ghi F lÃ  em báº£o lÆ°u áº¡, nhÆ°ng Ä‘iá»ƒm há»‡ sá»‘ 4 cá»§a em láº¡i ghi 0.45 lÃ   nhÆ° nÃ o áº¡, mong cÃ¡c tháº§y cÃ´ giáº£i Ä‘Ã¡p há»™ em', 'intent': 'DIEM'}
{'content': 'vá»›i tiÃªu chÃ­ xÃ©t há»c bá»•ng nÄƒm 2 lÃ  báº¯t buá»™c qua tacb1,2 hay pháº£i Ä‘áº¡t 250 toeic áº¡ ', 'intent': 'HOC_BONG'}
{'content': 'Em chÃ o tháº§y cÃ´ áº¡. Em xin Ä‘Æ°á»£c cÃ³ má»™t vÃ i lá»i vá» váº¥n Ä‘á» há»c bá»•ng cá»§a nhÃ  trÆ°á»ng áº¡. TrÆ°á»›c tiÃªn em xin chÃ¢n thÃ nh cáº£m Æ¡n quÃ½ tháº§y cÃ´ vÃ  nhÃ  trÆ°á»ng Ä‘Ã£ táº¡o Ä‘iá»u kiá»‡n cho em cÅ©ng nhÆ° cÃ¡c anh chá»‹, cÃ¡c báº¡n sinh viÃªn Ä‘Æ°á»£c há»c táº­p vÃ  thÃªm vÃ o Ä‘Ã³ lÃ  nhá»¯ng suáº¥t há»c bá»•ng nhá»¯ng pháº§n quÃ  Ä‘á»ƒ Ä‘á»™ng viÃªn tinh tháº§n há»c táº­p cá»§a sinh viÃªn chÃºng em. Theo em Ä‘Æ°á»£c biáº¿t thÃ¬ trong khoáº£ng thá»i gian trÆ°á»›c thá»i Ä‘iá»ƒm hiá»‡n táº¡i thÃ¬ nhÃ  trÆ°á»ng Ä‘Ã£ tiáº¿n hÃ nh trao há»c bá»•ng cho sinh viÃªn trong diá»‡n Ä‘Æ°á»£c xÃ©t há»c bá»•ng cá»§a kÃ¬ há»c trÆ°á»›c. Má»™t vÃ i báº¡n trong lá»›p em Ä‘Ã£ nháº­n Ä‘Æ°á»£c há»c bá»•ng nhÆ°ng riÃªng vá» cÃ¡ nhÃ¢n em thÃ¬ em váº«n chÆ°a nháº­n Ä‘Æ°á»£c há»c bá»•ng áº¡. Em khÃ´ng rÃµ lÃ  do cÃ³ sai sÃ³t gÃ¬ khÃ´ng nÃªn em ráº¥t mong nhÃ  trÆ°á»ng xem xÃ©t láº¡i vÃ  cho em lá»i Ä‘Ã¡p áº¡. Nhá»¯ng lá»i em nÃ³i á»Ÿ trÃªn náº¿u cÃ³ chá»— nÃ o khÃ´ng phÃ¹ há»£p thÃ¬ cho em xin lá»—i áº¡. Em ráº¥t mong nháº­n Ä‘Æ°á»£c há»“i Ã¢m áº¡. Em xin chÃ¢n thÃ nh cáº£m Æ¡n áº¡!', 'intent': 'HOC_BONG'}
{'content': 'Trong khoáº£ng thá»i gian chá» báº±ng, em cÃ³ Ä‘Æ°á»£c phÃ©p Ä‘Äƒng kÃ½ há»c láº¡i mÃ´n há»c Ä‘á»ƒ nÃ¢ng Ä‘iá»ƒm tÃ­ch lÅ©y hay khÃ´ng?', 'intent': 'DKMH'}
{'content': 'Em Ä‘Ã£ báº£o vá»‡ Ä‘á»“ Ã¡n tá»‘t nghiá»‡p thÃ¬ cÃ³ thá»ƒ há»c láº¡i Ä‘á»ƒ cáº£i thiá»‡n Ä‘iá»ƒm cÃ¡c mÃ´n khÃ´ng áº¡', 'intent': 'DKMH'}
{'content': 'Em muá»‘n xin hoÃ£n xÃ©t tá»‘t nghiá»‡p Ä‘á»ƒ há»c cáº£i thiá»‡n thÃ¬ cÃ³ Ä‘Æ°á»£c khÃ´ng áº¡, vÃ  lÃ m cÃ¡ch nÃ o Ä‘á»ƒ Ä‘Äƒng kÃ½ mÃ´n há»c áº¡', 'intent': 'DKMH'}
{'content': 'ThÆ°a tháº§y, em há»c khÃ³a 62 em cÃ³ thá»ƒ há»c láº¡i mÃ´n cÆ¡ há»c Ä‘áº¥t khÃ³a 64 Ä‘Æ°á»£c khÃ´ng áº¡. VÃ¬ em tháº¥y mÃ£ mÃ´n há»c khÃ¡c nhau (138802, 130211)', 'intent': 'DKMH'}
{'content': 'Cho em há»i em cÃ³ thá»ƒ Ä‘Äƒng kÃ½ tráº£ ná»£ mÃ´n há»c cÃ¹ng tÃªn nhÆ°ng khÃ¡c mÃ£ Ä‘Æ°á»£c khÃ´ng áº¡?', 'intent': 'DKMH'}
{'content': 'Em chÃ o cÃ´. CÃ´ cho em\xa0há»i\xa0lÃ¢u ná»¯a khÃ´ng sáº½ cÃ³ Ä‘á»£t huá»· mÃ´n há»c mÃ  mÃ¬nh Ä‘Äƒng kÃ­ nháº§m váº­y cÃ´. Em cáº£m Æ¡n cÃ´ nhiá»u.', 'intent': 'DKMH'}
{'content': 'Cho em há»i náº¿u em Ä‘Äƒng kÃ½ mÃ´n há»c mÃ  bá»‹ nháº§m thÃ¬ cÃ³ há»§y Ä‘Æ°á»£c khÃ´ng áº¡', 'intent': 'DKMH'}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>CÃ¡c cÃ¢u há»i Ä‘Æ°á»£c chia thÃ nh 10 nhÃ³m Ã½ Ä‘á»‹nh: <code class="language-plaintext highlighter-rouge">['DIEM', 'HOC_BONG', 'DKMH', 'HOC_PHI', 'KHAC', 'LICH_HOC', 'TAI_KHOAN', 'THU_TUC_SV', 'TN', 'TOEIC']</code>
Trong Ä‘Ã³</p>
<ul>
  <li>â€˜DIEMâ€™ bao gá»“m cÃ¡c cÃ¢u há»i tháº¯c máº¯c vá» Äiá»ƒm</li>
  <li>â€˜HOC_BONGâ€™ bao gá»“m cÃ¡c cÃ¢u há»i tháº¯c máº¯c vá» Há»c bá»•ng</li>
  <li>â€˜DKMHâ€™ bao gá»“m cÃ¡c cÃ¢u há»i tháº¯c máº¯c vá» viá»‡c Ä‘Äƒng kÃ½ mÃ´n há»c</li>
  <li>â€˜HOC_PHIâ€™ bao gá»“m cÃ¡c cÃ¢u há»i tháº¯c máº¯c vá» há»c phÃ­</li>
</ul>

<p>â€¦</p>

<ul>
  <li>â€˜KHACâ€™ bao gá»“m cÃ¡c cÃ¢u há»i khÃ´ng thuá»™c vÃ o 1 trong 9 nhÃ³m trÃªn</li>
</ul>

<h1 id="xÃ¢y-dá»±ng-mÃ´-hÃ¬nh">XÃ¢y dá»±ng mÃ´ hÃ¬nh</h1>

<h2 id="tÃ i-nguyÃªn">TÃ i nguyÃªn</h2>

<p>Dá»¯ liá»‡u, pre-trained cÃ¡c mÃ´ hÃ¬nh biá»ƒu diá»…n tá»« cÃ¡c báº¡n cÃ³ thá»ƒ download <a href="https://drive.google.com/drive/folders/1EqS0xTEGGaQM-uAb6phbmLOfUkWjjZNy?usp=sharing">á»Ÿ Ä‘Ã¢y</a>.</p>

<h2 id="cÃ i-Ä‘áº·t-cÃ¡c-gÃ³i-cáº§n-thiáº¿t">CÃ i Ä‘áº·t cÃ¡c gÃ³i cáº§n thiáº¿t</h2>

<p>Trong bÃ i nÃ y mÃ¬nh sá»­ dá»¥ng thÆ° viá»‡n <code class="language-plaintext highlighter-rouge">pyvi</code> Ä‘á»ƒ tiáº¿n hÃ nh má»™t sá»‘ tiá»n xá»­ lÃ½ vá»›i vÄƒn báº£n. Äá»ƒ cÃ i Ä‘áº·t báº¡n cháº¡y lá»‡nh sau:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pip3 <span class="nb">install </span>pyvi
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="import-cÃ¡c-thÆ°-viá»‡n-cáº§n-thiáº¿t">Import cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c1"># -*- coding: utf-8 -*-
</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">re</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">string</span>
<span class="kn">from</span> <span class="nn">pyvi</span> <span class="kn">import</span> <span class="n">ViTokenizer</span>
<span class="kn">from</span> <span class="nn">pyvi.ViTokenizer</span> <span class="kn">import</span> <span class="n">tokenize</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="nn">gensim.models.fasttext</span> <span class="kn">import</span> <span class="n">FastText</span> 
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span><span class="p">;</span> <span class="n">plt</span><span class="p">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="khai-bÃ¡o-cÃ¡c-hÃ m-tiá»n-xá»­-lÃ½">Khai bÃ¡o cÃ¡c hÃ m tiá»n xá»­ lÃ½</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="c1"># Loáº¡i bá» cÃ¡c kÃ½ tá»± thá»«a
</span><span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'&lt;.*?&gt;'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">text</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'(\s)+'</span><span class="p">,</span> <span class="sa">r</span><span class="s">'\1'</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1">#tÃ¡ch cÃ¢u
</span><span class="k">def</span> <span class="nf">sentence_segment</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">sents</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"([.?!])?[</span><span class="se">\n</span><span class="s">]+|[.?!] "</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sents</span>

<span class="c1">#tÃ¡ch tá»«
</span><span class="k">def</span> <span class="nf">word_segment</span><span class="p">(</span><span class="n">sent</span><span class="p">):</span>
    <span class="n">sent</span> <span class="o">=</span> <span class="n">tokenize</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sent</span>

<span class="c1">#Chuáº©n hÃ³a tá»«
</span><span class="k">def</span> <span class="nf">normalize_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">listpunctuation</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">punctuation</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'_'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">listpunctuation</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s">' '</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Äá»ƒ loáº¡i bá» tá»« dá»«ng, mÃ¬nh dÃ¹ng danh sÃ¡ch tá»« dá»«ng, cÃ¡c báº¡n thay <code class="language-plaintext highlighter-rouge">stopwords.csv</code> báº±ng Ä‘Æ°á»ng dáº«n trong file mÃ¬nh Ä‘á»ƒ bÃªn trÃªn.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="n">filename</span> <span class="o">=</span> <span class="s">'stopwords.csv'</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="n">list_stopwords</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'stopwords'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">remove_stopword</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">pre_text</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_stopwords</span><span class="p">:</span>
            <span class="n">pre_text</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="n">text2</span> <span class="o">=</span> <span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">pre_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text2</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="huáº¥n-luyá»‡n-mÃ´-hÃ¬nh-fasttext-phÃ¹-há»£p-vá»›i-dá»¯-liá»‡u-bÃ i-toÃ¡n">Huáº¥n luyá»‡n mÃ´ hÃ¬nh FastText phÃ¹ há»£p vá»›i dá»¯ liá»‡u bÃ i toÃ¡n</h2>

<p>Trong bÃ i nÃ y mÃ¬nh sá»­ dá»¥ng FastText trong gÃ³i thÆ° viá»‡n cá»§a Gensim Ä‘á»ƒ thá»±c hiá»‡n mÃ£ hÃ³a cÃ¡c tá»« thÃ nh vector (word2vec). Dá»¯ liÃªu huáº¥n luyá»‡n mÃ¬nh Ä‘á»ƒ trong file <code class="language-plaintext highlighter-rouge">xaa</code>. 
FastText Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ lÃ  tá»‘t hÆ¡n so vá»›i word2vec trong viá»‡c biá»ƒu diá»…n cÃ¡c tá»« má»›i nÃªn mÃ¬nh sáº½ sá»­ dá»¥ng trong bÃ i toÃ¡n nÃ y.
ÄÃ¢y lÃ  file gá»“m 1 pháº§n cÃ¡c bÃ i viáº¿t tá»« wikipedia tiáº¿ng viá»‡t, cÃ¡c vÄƒn báº£n Ä‘Ã£ Ä‘Æ°á»£c tiá»n xá»­ lÃ½ báº±ng má»™t sá»‘
ká»¹ thuáº­t nhÆ° tÃ¡ch tá»«, loáº¡i bá» tá»« dá»«ng, chuáº©n hÃ³aâ€¦</p>

<p>NgoÃ i ra mÃ¬nh cÅ©ng cáº§n bá»• sung cÃ¡c cÃ¢u trong file dá»¯ liá»‡u cá»§a bá»™ dá»¯ liá»‡u phÃ¢n loáº¡i Ã½ Ä‘á»‹nh Ä‘á»ƒ huáº¥n luyá»‡n cho mÃ´ hÃ¬nh word2vec. 
Äiá»u nÃ y giÃºp bá»• sung má»™t sá»‘ tá»« trong miá»n dá»¯ liá»‡u cá»§a topology mÃ  trong bá»™ ngá»¯ liá»‡u cá»§a wikipedia khÃ´ng cÃ³. Äiá»u nÃ y giÃºp mÃ´ hÃ¬nh FastText cÃ³ kháº£ nÄƒng biá»ƒu diá»…n Ä‘áº§y Ä‘á»§ hÆ¡n.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">json</span> 
    
<span class="n">wiki_data_path</span> <span class="o">=</span> <span class="s">'xaa'</span>
<span class="n">qa_data_path</span> <span class="o">=</span> <span class="s">'intent_db_v2.json'</span>

<span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">traindata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sents</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pathdata</span><span class="p">,</span> <span class="s">'r'</span><span class="p">).</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">sents</span><span class="p">:</span>
        <span class="n">traindata</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">sent</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">qa_data_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">qa_data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>  
        <span class="k">for</span> <span class="n">question</span> <span class="ow">in</span> <span class="n">qa_data</span><span class="p">:</span> 
            <span class="k">if</span> <span class="s">'content'</span> <span class="ow">in</span> <span class="n">question</span> <span class="p">:</span>
              <span class="n">content</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">question</span><span class="p">[</span><span class="s">'content'</span><span class="p">])</span> 
              <span class="n">content</span> <span class="o">=</span> <span class="n">word_segment</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
              <span class="n">content</span> <span class="o">=</span> <span class="n">remove_stopword</span><span class="p">(</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">content</span><span class="p">))</span>
              <span class="n">traindata</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">content</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Corpus loaded"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">traindata</span><span class="p">,</span> <span class="n">qa_data</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">qa_data</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="n">wiki_data_path</span><span class="p">)</span>


</pre></td></tr></tbody></table></code></pre></div></div>

<p>Huáº¥n luyá»‡n mÃ´ hÃ¬nh FastText nhÆ° sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">model_fasttext</span> <span class="o">=</span> <span class="n">FastText</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model_fasttext</span><span class="p">.</span><span class="n">build_vocab</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
<span class="n">model_fasttext</span><span class="p">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">total_examples</span><span class="o">=</span><span class="n">model_fasttext</span><span class="p">.</span><span class="n">corpus_count</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">model_fasttext</span><span class="p">.</span><span class="nb">iter</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau khi Ä‘Ã£ huáº¥n luyá»‡n xong cÃ¡c báº¡n cáº§n lÆ°u láº¡i model Ä‘á»ƒ sá»­ dá»¥ng cho láº§n sau báº±ng Ä‘oáº¡n code sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">model_fasttext</span><span class="p">.</span><span class="n">wv</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"fasttext_gensim.model"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Äá»ƒ loáº¡i láº¡i mÃ´ hÃ¬nh chÃºng ta lÃ m nhÆ° sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">fast_text_model</span> <span class="o">=</span> <span class="n">KeyedVectors</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/NUCE/NLP/QA/model/fasttext_gensim.model'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In thá»­ kÃ­ch thÆ°á»›c má»™t tá»«:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">input_text</span> <span class="o">=</span> <span class="n">fast_text_model</span><span class="p">.</span><span class="n">wv</span><span class="p">.</span><span class="n">get_vector</span><span class="p">(</span><span class="s">"hÃ´m_nay"</span><span class="p">)</span> 
<span class="k">print</span><span class="p">(</span><span class="n">input_text</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>(150,)
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="biá»ƒu-diá»…n-tá»«-vÃ -biá»ƒu-diá»…n-cÃ¢u">Biá»ƒu diá»…n tá»« vÃ  biá»ƒu diá»…n cÃ¢u</h2>

<p>Sau khi Ä‘Ã£ huáº¥n luyá»‡n mÃ´ hÃ¬nh FastText, chÃºng ta sáº½ tiáº¿n hÃ nh mÃ£ hÃ³a cÃ¡c cÃ¢u thÃ nh vector báº±ng cÃ¡ch mÃ£ hÃ³a tá»«ng tá»« trong cÃ¢u vÃ  Ä‘Æ°a cÃ¡c vector biá»ƒu diá»…n cÃ¡c tá»« nÃ y vÃ o má»™t vector cÃ³ kÃ­ch thÆ°á»›c báº±ng sá»‘ tá»« cá»§a cÃ¢u dÃ i nháº¥t (Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c cÃ¢u Ä‘á»u Ä‘Æ°á»£c biá»ƒu diá»…n Ä‘áº§y Ä‘á»§).
CÃ¡c cÃ¢u ngáº¯n hÆ¡n Ä‘á»™ dÃ i cá»§a cÃ¢u dÃ i nháº¥t sáº½ Ä‘Æ°á»£c thÃªm padding lÃ  cÃ¡c sá»‘ 0 Ä‘á»ƒ Ä‘Æ°a cÃ¡c cÃ¢u vá» cÃ¹ng kÃ­ch thÆ°á»›c mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n Ã½ nghÄ©a cá»§a cÃ¢u. Viá»‡c padding mÃ¬nh sá»­ dá»¥ng hÃ m <code class="language-plaintext highlighter-rouge">tf.keras.preprocessing.sequence.pad_sequences</code></p>

<p>Code thá»±c hiá»‡n nhÆ° sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">max_length_inp</span> <span class="o">=</span> <span class="mi">30</span>
<span class="k">def</span> <span class="nf">sentence_embedding</span><span class="p">(</span><span class="n">sent</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span> 
    <span class="n">content</span> <span class="o">=</span> <span class="n">word_segment</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">remove_stopword</span><span class="p">(</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">content</span><span class="p">))</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">content</span><span class="p">.</span><span class="n">split</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">fast_text_model</span><span class="p">.</span><span class="n">wv</span><span class="p">.</span><span class="n">vocab</span><span class="p">:</span>
        <span class="n">inputs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fast_text_model</span><span class="p">.</span><span class="n">wv</span><span class="p">.</span><span class="n">get_vector</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">preprocessing</span><span class="p">.</span><span class="n">sequence</span><span class="p">.</span><span class="n">pad_sequences</span><span class="p">([</span><span class="n">inputs</span><span class="p">],</span>
                                                                <span class="n">maxlen</span><span class="o">=</span><span class="n">max_length_inp</span><span class="p">,</span>
                                                                <span class="n">dtype</span><span class="o">=</span><span class="s">'float32'</span><span class="p">,</span>
                                                                <span class="n">padding</span><span class="o">=</span><span class="s">'post'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inputs</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="Ä‘á»c-dá»¯-liá»‡u">Äá»c dá»¯ liá»‡u</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">json</span> 

<span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">qa_data_input</span><span class="p">):</span>
  <span class="n">sentences</span> <span class="o">=</span> <span class="p">[]</span> 
  <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">intents</span> <span class="o">=</span> <span class="p">[]</span> 
  <span class="k">for</span> <span class="n">question</span> <span class="ow">in</span> <span class="n">qa_data</span><span class="p">:</span> 
    <span class="k">if</span> <span class="s">'intent'</span> <span class="ow">in</span> <span class="n">question</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">question</span><span class="p">[</span><span class="s">'intent'</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">intents</span><span class="p">:</span> 
        <span class="n">intents</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">question</span><span class="p">[</span><span class="s">'intent'</span><span class="p">])</span> 
      <span class="n">sentences</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">sentence_embedding</span><span class="p">(</span><span class="n">question</span><span class="p">[</span><span class="s">'content'</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">labels</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">intents</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">question</span><span class="p">[</span><span class="s">'intent'</span><span class="p">]))</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Corpus loaded"</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">sentences</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">intents</span>

<span class="n">sentences</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">intents</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="n">qa_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="phÃ¢n-chia-dá»¯-liá»‡u">PhÃ¢n chia dá»¯ liá»‡u</h2>

<p>VÃ¬ dá»¯ liá»‡u trong cÃ¡c class lÃ  khÃ´ng Ä‘á»u nhau, vÃ¬ váº­y Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ chÃ­nh xÃ¡c mÃ´ hÃ¬nh ta cáº§n phÃ¢n chia dá»¯ liá»‡u Ä‘Ã¡nh giÃ¡ sao cho sá»‘ lÆ°á»£ng cÃ¡c samples trong cÃ¡c class báº±ng nhau.</p>

<p>ÄÃ¢y lÃ  hÃ¬nh áº£nh sá»‘ lÆ°á»£ng cÃ¡c cÃ¢u há»i trong cÃ¡c class tÆ°Æ¡ng á»©ng:</p>

<p><img src="/assets/img/blog/Screen Shot 2021-04-15 at 23.05.49.png" alt="Sá»‘ lÆ°á»£ng cÃ¡c cÃ¢u há»i trong cÃ¡c class" />
<em>Sá»‘ lÆ°á»£ng cÃ¡c cÃ¢u há»i trong cÃ¡c class</em></p>

<p>Äá»ƒ phÃ¢n chia sao cho cÃ¡c cÃ¢u há»i trong cÃ¡c class cá»§a táº­p validate nhÆ° nhau ta thá»±c hiá»‡n nhÆ° sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">split_balanced</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="c1"># can give test_size as fraction of input data size of number of samples
</span>    <span class="k">if</span> <span class="n">test_size</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">n_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">*</span><span class="n">test_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_test</span> <span class="o">=</span> <span class="n">test_size</span>
    <span class="n">n_train</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">-</span><span class="n">n_test</span><span class="p">)</span>
    <span class="n">n_train_per_class</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n_train</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">))))</span>
    <span class="n">n_test_per_class</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n_test</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">))))</span>

    <span class="n">ixs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n_train_per_class</span><span class="o">+</span><span class="n">n_test_per_class</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">target</span><span class="o">==</span><span class="n">cl</span><span class="p">):</span>
            <span class="c1"># if data has too few samples for this class, do upsampling
</span>            <span class="c1"># split the data to training and testing before sampling so data points won't be
</span>            <span class="c1">#  shared among training and test data
</span>            <span class="n">splitix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_train_per_class</span><span class="o">/</span><span class="p">(</span><span class="n">n_train_per_class</span><span class="o">+</span><span class="n">n_test_per_class</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">target</span><span class="o">==</span><span class="n">cl</span><span class="p">)))</span>
            <span class="n">ixs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">target</span><span class="o">==</span><span class="n">cl</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="n">splitix</span><span class="p">],</span> <span class="n">n_train_per_class</span><span class="p">),</span>
                <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">target</span><span class="o">==</span><span class="n">cl</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">splitix</span><span class="p">:],</span> <span class="n">n_test_per_class</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ixs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">target</span><span class="o">==</span><span class="n">cl</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_train_per_class</span><span class="o">+</span><span class="n">n_test_per_class</span><span class="p">,</span>
                <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>

    <span class="c1"># take same num of samples from all classes
</span>    <span class="n">ix_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="n">n_train_per_class</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ixs</span><span class="p">])</span>
    <span class="n">ix_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">n_train_per_class</span><span class="p">:(</span><span class="n">n_train_per_class</span><span class="o">+</span><span class="n">n_test_per_class</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ixs</span><span class="p">])</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ix_train</span><span class="p">,:]</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ix_test</span><span class="p">,:]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">ix_train</span><span class="p">]</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">ix_test</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Tiáº¿n hÃ nh chia dá»¯ liá»‡u huáº¥n luyá»‡n vÃ  kiá»ƒm tra:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">trainX</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
<span class="n">trainy</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">intents</span><span class="p">))</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">split_balanced</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainy</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="Ä‘á»‹nh-nghÄ©a-mÃ´-hÃ¬nh">Äá»‹nh nghÄ©a mÃ´ hÃ¬nh</h2>

<p>Trong bÃ i nÃ y mÃ¬nh sá»­ dá»¥ng LSTM Ä‘á»ƒ tiáº¿n hÃ nh phÃ¢n lá»›p. Máº¡ng LSTM Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i keras báº±ng cÃ¡ch khÃ¡ Ä‘Æ¡n giáº£n nhÆ° sau</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1">#model A
</span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">max_length_inp</span><span class="p">,</span> <span class="n">fast_text_model</span><span class="p">.</span><span class="n">vector_size</span><span class="p">)))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intents</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s">'categorical_crossentropy'</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Xem chi tiáº¿t sá»‘ lÆ°á»£ng cÃ¡c tham sá»‘ mÃ´ hÃ¬nh:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128)               142848    
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 64)                8256      
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 151,754
Trainable params: 151,754
Non-trainable params: 0
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="huáº¥n-luyá»‡n-mÃ´-hÃ¬nh">Huáº¥n luyá»‡n mÃ´ hÃ¬nh</h2>

<p>Äá»ƒ huáº¥n luyÃªn mÃ´ hÃ¬nh chÃºng ta sáº½ fit dá»¯ liá»‡u huáº¥n luyá»‡n vÃ  kiá»ƒm tra nhÆ° sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">tensorboard_callback</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Tham sá»‘ <code class="language-plaintext highlighter-rouge">verbose=1</code> Ä‘á»ƒ chá»‰ Ä‘á»‹nh in ra káº¿t quáº£ Ä‘Ã¡nh giÃ¡ sau má»—i láº§n thá»±c hiá»‡n xong 1 epoch</p>

<p>Káº¿t quáº£ sau khi cháº¡y xong 1 sá»‘ epochs nhÆ° sau:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>.....
Epoch 246/300
87/87 [==============================] - 1s 13ms/step - loss: 0.0073 - accuracy: 0.9941 - val_loss: 1.7335 - val_accuracy: 0.8364
Epoch 247/300
87/87 [==============================] - 1s 13ms/step - loss: 0.0119 - accuracy: 0.9915 - val_loss: 1.7414 - val_accuracy: 0.8295
Epoch 248/300
87/87 [==============================] - 1s 13ms/step - loss: 0.0074 - accuracy: 0.9929 - val_loss: 1.7672 - val_accuracy: 0.8295
Epoch 249/300
87/87 [==============================] - 1s 13ms/step - loss: 0.0098 - accuracy: 0.9915 - val_loss: 1.7550 - val_accuracy: 0.8295
Epoch 250/300
87/87 [==============================] - 1s 14ms/step - loss: 0.0050 - accuracy: 0.9966 - val_loss: 1.7392 - val_accuracy: 0.8364
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="Ä‘Ã¡nh-giÃ¡-mÃ´-hÃ¬nh">ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh</h2>

<p>Import cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t Ä‘á»ƒ Ä‘Ã¡nh giÃ¡:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">recall_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">cohen_kappa_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">multilabel_confusion_matrix</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ChÃºng ta sáº½ tiáº¿n hÃ nh Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh dá»±a trÃªn cÃ¡c chá»‰ sá»‘ nhÆ° f1_score, Ä‘á»™ chÃ­nh xÃ¡c (accuracy) nhÆ° sau:</p>

<p>CÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Ã¡nh giÃ¡ há»‡ thá»‘ng phÃ¢n lá»›p cÃ¡c báº¡n cÃ³ thá»ƒ xem <a href="https://ndquy.github.io/posts/bai-toan-phan-lop-va-danh-gia/">táº¡i Ä‘Ã¢y</a></p>

<ul>
  <li>f1-score</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">yhat_classes</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y_test_true</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">label</span> <span class="o">==</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">y_test</span><span class="p">])</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">yhat_classes</span><span class="p">,</span> <span class="n">y_test_true</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s">'weighted'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Káº¿t quáº£ in ra sáº½ Ä‘Æ°á»£c:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>0.8303684789128464
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Äá»™ chÃ­nh xÃ¡c</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="s">"Evaluate on test data"</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"test loss, test acc:"</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Káº¿t quáº£:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Evaluate on test data
44/44 [==============================] - 0s 5ms/step - loss: 1.2874 - accuracy: 0.8272
test loss, test acc: [1.2874339818954468, 0.8271889686584473]
</pre></td></tr></tbody></table></code></pre></div></div>

<p>NhÆ° váº­y káº¿t quáº£ dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh trÃªn táº­p kiá»ƒm tra Ä‘áº¡t 82.7 %. Káº¿t quáº£ chÆ°a cao láº¯m nhÆ°ng cÃ³ thá»ƒ cháº¥p nháº­n Ä‘Æ°á»£c.</p>

<h2 id="fine-tune-láº¡i-mÃ´-hÃ¬nh">Fine-tune láº¡i mÃ´ hÃ¬nh</h2>

<p>Äá»ƒ nÃ¢ng cao Ä‘á»™ chÃ­nh xÃ¡c cá»§a mÃ´ hÃ¬nh, báº¡n Ä‘á»c cÃ³ thá»ƒ thá»­ nghiá»‡m cÃ¡c thay Ä‘á»•i báº±ng cÃ¡ch sá»­ dá»¥ng mÃ´ hÃ¬nh biá»ƒu diá»…n tá»« tá»‘t hÆ¡n hoáº·c sá»­ dá»¥ng mÃ´ hÃ¬nh khÃ¡c nhÆ° BERT, GRU, RNNâ€¦
NgoÃ i ra chÃºng ta cÃ³ thá»ƒ thá»­ nghiá»‡m thay Ä‘á»•i cÃ¡c tham sá»‘ Ä‘á»ƒ vÃ  so sÃ¡nh cÃ¡c thay Ä‘á»•i Ä‘á»ƒ Ä‘Æ°a ra Ä‘Æ°á»£c mÃ´ hÃ¬nh tá»‘t nháº¥t.</p>

<h1 id="tá»•ng-káº¿t">Tá»•ng káº¿t</h1>

<p>BÃ i viáº¿t mÃ¬nh Ä‘Ã£ vá»«a trÃ¬nh bÃ y vá» ká»¹ thuáº­t xÃ¡c Ä‘á»‹nh Ã½ Ä‘á»‹nh cá»§a cÃ¢u há»i sá»­ dá»¥ng deeplearning. Má»i tháº¯c máº¯c vÃ  Ã½ kiáº¿n Ä‘Ã³ng gÃ³p cÃ¡c báº¡n cÃ³ thá»ƒ trao Ä‘á»•i dÆ°á»›i bÃ i viáº¿t nÃ y.</p>

<p>CÃ¡m Æ¡n cÃ¡c báº¡n Ä‘Ã£ Ä‘á»c bÃ i viáº¿t.</p>

:ET